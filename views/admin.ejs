<%- include('partials/header') %>

<main class="container" style="margin-top: 30px; padding-bottom: 50px">
  <div class="section-header">
    <h2><i class="fa fa-plus-circle"></i> ĐĂNG MÁY MỚI</h2>
  </div>

  <form action="/admin/add" method="POST" enctype="multipart/form-data" class="admin-form" style="background: #1e293b; padding: 25px; border-radius: 12px; border: 1px solid #334155; margin-bottom: 40px;">
    <div class="form-group" style="margin-bottom: 15px">
      <label>Tên sản phẩm (Ví dụ: Latitude 7400):</label>
      <input type="text" name="name" required class="form-control" style="width: 100%; padding: 10px; background: #0f172a; color: white; border: 1px solid #334155; border-radius: 5px;" />
    </div>

    <div style="display: flex; gap: 20px; margin-bottom: 15px">
      <div style="flex: 1">
        <label>Hãng (Dell, HP, Canon...):</label>
        <input type="text" name="brand" class="form-control" style="width: 100%; padding: 10px; background: #0f172a; color: white; border: 1px solid #334155; border-radius: 5px;" />
      </div>
      <div style="flex: 1">
        <label>Giá bán (VNĐ):</label>
        <input type="number" name="price" required class="form-control" style="width: 100%; padding: 10px; background: #0f172a; color: white; border: 1px solid #334155; border-radius: 5px;" />
      </div>
    </div>

    <div class="form-group" style="margin-bottom: 15px">
      <label>Cấu hình (CPU / RAM / SSD):</label>
      <input type="text" name="short_specs" class="form-control" style="width: 100%; padding: 10px; background: #0f172a; color: white; border: 1px solid #334155; border-radius: 5px;" />
    </div>

    <div class="form-group" style="margin-bottom: 20px">
      <label>Hình ảnh thực tế:</label>
      <input type="file" name="image" accept="image/*" class="form-control" style="width: 100%; padding: 8px; background: #0f172a; color: white" />
    </div>

    <button type="submit" class="btn-submit" style="width: 100%; padding: 12px; background: #f37021; color: white; border: none; border-radius: 6px; font-weight: bold; cursor: pointer;">
      <i class="fa fa-upload"></i> ĐĂNG LÊN WEB
    </button>
  </form>

  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
    <div style="background: #1e293b; padding: 20px; border-radius: 12px; border-left: 5px solid #f37021; border: 1px solid #334155;">
        <small style="color: #94a3b8; text-transform: uppercase;">Tổng số máy trong kho</small>
        <h3 style="font-size: 24px; margin-top: 5px;"><%= products.length %> Máy</h3>
    </div>
    <div style="background: #1e293b; padding: 20px; border-radius: 12px; border-left: 5px solid #22c55e; border: 1px solid #334155;">
        <small style="color: #94a3b8; text-transform: uppercase;">Tổng giá trị tồn kho</small>
        <h3 style="font-size: 24px; margin-top: 5px; color: #22c55e;">
            <%= products.reduce((total, p) => total + Number(p.price), 0).toLocaleString() %>đ
        </h3>
    </div>
  </div>

  <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
    <h2><i class="fa fa-tasks"></i> KHO MÁY HIỆN CÓ</h2>
    
    <form action="/admin" method="GET" style="display: flex; gap: 5px; min-width: 300px;">
        <input type="text" name="q" value="<%= typeof query !== 'undefined' ? query : '' %>" placeholder="Tìm tên máy, hãng..." style="flex: 1; padding: 8px 15px; border-radius: 5px; border: 1px solid #334155; background: #0f172a; color: white; outline: none;">
        <button type="submit" style="background: #2563eb; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;"><i class="fa fa-search"></i></button>
        <% if(typeof query !== 'undefined' && query != '') { %>
            <a href="/admin" style="background: #475569; color: white; text-decoration: none; padding: 8px 12px; border-radius: 5px; font-size: 12px;">XÓA</a>
        <% } %>
    </form>
  </div>

  <div style="overflow-x: auto; background: #1e293b; border-radius: 12px; border: 1px solid #334155;">
    <table style="width: 100%; border-collapse: collapse; color: white; text-align: left;">
      <thead style="background: #0f172a">
        <tr>
          <th style="padding: 15px">Ảnh</th>
          <th style="padding: 15px">Thông tin máy</th>
          <th style="padding: 15px">Giá</th>
          <th style="padding: 15px">Thao tác</th>
        </tr>
      </thead>
      <tbody>
        <% products.forEach(product => { %>
        <tr style="border-top: 1px solid #334155">
          <td style="padding: 15px">
            <img src="/images/<%= product.image %>" width="60" style="border-radius: 4px; background: white" />
          </td>
          <td style="padding: 15px">
            <b style="color: #f37021"><%= product.name %></b><br />
            <small><%= product.short_specs %></small>
          </td>
          <td style="padding: 15px; font-weight: bold; color: #ef4444">
            <%= Number(product.price).toLocaleString() %>đ
          </td>
          <td style="padding: 15px">
            <a href="/admin/edit/<%= product.id %>" style="background: #2563eb; color: white; padding: 7px 15px; border-radius: 5px; text-decoration: none; font-size: 13px; font-weight: bold; margin-right: 8px; display: inline-block;">
              <i class="fa fa-edit"></i> SỬA
            </a>
            <a href="/admin/delete/<%= product.id %>" onclick="return confirm('Anh Trinh chắc chắn xóa máy này chứ?')" style="background: #dc2626; color: white; padding: 7px 15px; border-radius: 5px; text-decoration: none; font-size: 13px; font-weight: bold; display: inline-block;">
              <i class="fa fa-trash"></i> XÓA
            </a>
          </td>
        </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</main>

<%- include('partials/footer') %>